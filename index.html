<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶∏‡ßÄ‡¶∞‡¶æ‡¶§‡ßÅ‡¶® ‡¶®‡¶¨‡ßÄ Ô∑∫ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #d1fae5 0%, #99f6e4 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            padding: 40px;
            margin-bottom: 20px;
        }
        
        h1 {
            color: #065f46;
            font-size: 2.5em;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #6b7280;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .info-box {
            background: #d1fae5;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }
        
        .info-box h3 {
            color: #065f46;
            margin-bottom: 15px;
        }
        
        .info-box ul {
            list-style: none;
            padding: 0;
        }
        
        .info-box li {
            color: #374151;
            margin: 10px 0;
            padding-left: 25px;
        }
        
        .code-box {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            text-align: center;
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.3);
        }
        
        .code-label {
            color: white;
            font-size: 14px;
            margin-bottom: 10px;
            opacity: 0.9;
        }
        
        .verification-code {
            font-size: 16px;
            font-weight: bold;
            color: white;
            letter-spacing: 1px;
            font-family: 'Courier New', monospace;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            margin: 15px 0;
            word-break: break-all;
            line-height: 1.6;
        }
        
        .code-instruction {
            color: white;
            font-size: 14px;
            margin-top: 10px;
            opacity: 0.9;
        }
        
        .whatsapp-box {
            background: #dcf8c6;
            border: 2px solid #25D366;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }
        
        .whatsapp-box h3 {
            color: #075e54;
            margin-bottom: 10px;
        }
        
        .auto-save-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .auto-save-indicator.show {
            opacity: 1;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            color: #374151;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        input {
            width: 100%;
            padding: 15px;
            border: 2px solid #d1d5db;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus {
            outline: none;
            border-color: #10b981;
        }
        
        .btn {
            width: 100%;
            padding: 18px;
            font-size: 18px;
            font-weight: bold;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-primary {
            background: #10b981;
            color: white;
        }
        
        .btn-primary:hover:not(:disabled) {
            background: #059669;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #d1d5db;
            color: #374151;
            padding: 12px 24px;
            width: auto;
        }
        
        .btn-secondary:hover {
            background: #9ca3af;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .btn-danger:hover:not(:disabled) {
            background: #dc2626;
        }
        
        .btn-whatsapp {
            background: #25D366;
            color: white;
        }
        
        .btn-whatsapp:hover {
            background: #128C7E;
        }
        
        .timer-box {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .timer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .timer {
            color: #ef4444;
            font-size: 24px;
            font-weight: bold;
        }
        
        .timer.warning {
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: #10b981;
            transition: width 0.3s;
        }
        
        .question-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .question-badge {
            display: inline-block;
            background: #d1fae5;
            color: #065f46;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .question-text {
            font-size: 20px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 20px;
        }
        
        .option {
            width: 100%;
            padding: 18px;
            margin: 10px 0;
            border: 2px solid #d1d5db;
            border-radius: 10px;
            background: white;
            text-align: right;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
        }
        
        .option:hover {
            border-color: #10b981;
            background: #f0fdf4;
        }
        
        .option.selected {
            border-color: #10b981;
            background: #d1fae5;
        }
        
        .nav-buttons {
            display: flex;
            gap: 15px;
        }
        
        .nav-buttons button {
            flex: 1;
        }
        
        .success-icon {
            text-align: center;
            font-size: 80px;
            margin-bottom: 20px;
        }
        
        .success-message {
            text-align: center;
        }
        
        .success-message h2 {
            color: #065f46;
            font-size: 32px;
            margin-bottom: 15px;
        }
        
        .success-message p {
            color: #6b7280;
            font-size: 18px;
            margin: 10px 0;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #6b7280;
        }
        
        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            h1 {
                font-size: 1.8em;
            }
            
            .card {
                padding: 20px;
            }
            
            .verification-code {
                font-size: 14px;
            }
            
            .timer {
                font-size: 18px;
            }
            
            .question-text {
                font-size: 18px;
            }
            
            .option {
                padding: 15px;
                font-size: 15px;
            }
            
            .nav-buttons {
                flex-direction: column;
            }
            
            .nav-buttons button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div id="autoSaveIndicator" class="auto-save-indicator">‚úì ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§</div>
    <div id="app"></div>

    <script>
        // WhatsApp ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞
        const WHATSAPP_NUMBER = '8801886667466';
        
        // Encoding system - BACKGROUND mapping
        const ENCODE_MAP = ['B', 'A', 'C', 'K', 'G', 'R', 'O', 'U', 'N', 'D'];
        
        // Base64 encode
        function base64Encode(str) {
            try {
                const utf8Bytes = new TextEncoder().encode(str);
                let binary = '';
                utf8Bytes.forEach(byte => binary += String.fromCharCode(byte));
                return btoa(binary);
            } catch (e) {
                console.error('Encode error:', e);
                return '';
            }
        }
        
        // Generate verification code
        function generateVerificationCode(correct, wrong, unanswered, phone, name, timeTaken) {
            const namePhone = `${name}|${phone}`;
            const encodedNamePhone = base64Encode(namePhone);
            
            const c = ENCODE_MAP[correct] || 'B';
            const w = ENCODE_MAP[wrong] || 'B';
            const u = ENCODE_MAP[unanswered] || 'B';
            const resultCode = `${c}${w}${u}`;
            
            const timeMatch = timeTaken.match(/(\d+):(\d+)/);
            if (timeMatch) {
                const mins = parseInt(timeMatch[1]);
                const secs = parseInt(timeMatch[2]);
                
                const min1 = ENCODE_MAP[Math.floor(mins / 10)] || 'B';
                const min2 = ENCODE_MAP[mins % 10] || 'B';
                const sec1 = ENCODE_MAP[Math.floor(secs / 10)] || 'B';
                const sec2 = ENCODE_MAP[secs % 10] || 'B';
                
                const timeCode = `${min1}${min2}${sec1}${sec2}`;
                return `${encodedNamePhone}-${resultCode}-${timeCode}`;
            }
            
            return `${encodedNamePhone}-${resultCode}-BBBB`;
        }
        
        // ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶°‡¶æ‡¶ü‡¶æ - ‡¶∂‡ßÅ‡¶ß‡ßÅ MCQ
        const QUESTIONS = [
            {
                id: 1,
                type: 'mcq',
                question: '‡¶∞‡¶æ‡¶∏‡ßÇ‡¶≤‡ßÅ‡¶≤‡ßç‡¶≤‡¶æ‡¶π Ô∑∫ ‡¶ï‡ßã‡¶® ‡¶∏‡¶æ‡¶≤‡ßá ‡¶ú‡¶®‡ßç‡¶Æ‡¶ó‡ßç‡¶∞‡¶π‡¶£ ‡¶ï‡¶∞‡ßá‡¶®?',
                options: ['‡ß´‡ß≠‡ß¶ ‡¶ñ‡ßç‡¶∞‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶¨‡ßç‡¶¶', '‡ß´‡ß¨‡ß¶ ‡¶ñ‡ßç‡¶∞‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶¨‡ßç‡¶¶', '‡ß´‡ßÆ‡ß¶ ‡¶ñ‡ßç‡¶∞‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶¨‡ßç‡¶¶', '‡ß´‡ßØ‡ß¶ ‡¶ñ‡ßç‡¶∞‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶¨‡ßç‡¶¶'],
                correctAnswer: 0
            },
            {
                id: 2,
                type: 'mcq',
                question: '‡¶∞‡¶æ‡¶∏‡ßÇ‡¶≤‡ßÅ‡¶≤‡ßç‡¶≤‡¶æ‡¶π Ô∑∫ ‡¶è‡¶∞ ‡¶™‡¶ø‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶ï‡ßÄ?',
                options: ['‡¶Ü‡¶¨‡ßÅ ‡¶§‡¶æ‡¶≤‡¶ø‡¶¨', '‡¶Ü‡¶¨‡¶¶‡ßÅ‡¶≤‡ßç‡¶≤‡¶æ‡¶π', '‡¶Ü‡¶¨‡¶¶‡ßÅ‡¶≤ ‡¶Æ‡ßÅ‡¶§‡ßç‡¶§‡¶æ‡¶≤‡¶ø‡¶¨', '‡¶Ü‡¶¨‡ßÅ ‡¶¨‡¶ï‡¶∞'],
                correctAnswer: 1
            },
            {
                id: 3,
                type: 'mcq',
                question: '‡¶∞‡¶æ‡¶∏‡ßÇ‡¶≤‡ßÅ‡¶≤‡ßç‡¶≤‡¶æ‡¶π Ô∑∫ ‡¶è‡¶∞ ‡¶¶‡ßÅ‡¶ß ‡¶Æ‡¶æ‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶ï‡ßÄ?',
                options: ['‡¶Ü‡¶Æ‡¶ø‡¶®‡¶æ', '‡¶π‡¶æ‡¶≤‡¶ø‡¶Æ‡¶æ', '‡¶ñ‡¶æ‡¶¶‡¶ø‡¶ú‡¶æ', '‡¶Ü‡¶Ø‡¶º‡¶ø‡¶∂‡¶æ'],
                correctAnswer: 1
            },
            {
                id: 4,
                type: 'mcq',
                question: '‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶ï‡ßã‡¶® ‡¶Æ‡¶π‡¶ø‡¶≤‡¶æ ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ ‡¶ó‡ßç‡¶∞‡¶π‡¶£ ‡¶ï‡¶∞‡ßá‡¶®?',
                options: ['‡¶Ü‡¶Ø‡¶º‡¶ø‡¶∂‡¶æ ‡¶∞‡¶æ.', '‡¶´‡¶æ‡¶§‡¶ø‡¶Æ‡¶æ ‡¶∞‡¶æ.', '‡¶ñ‡¶æ‡¶¶‡¶ø‡¶ú‡¶æ ‡¶∞‡¶æ.', '‡¶π‡¶æ‡¶´‡¶∏‡¶æ ‡¶∞‡¶æ.'],
                correctAnswer: 2
            },
            {
                id: 5,
                type: 'mcq',
                question: '‡¶π‡¶ø‡¶ú‡¶∞‡¶§‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶∞‡¶æ‡¶∏‡ßÇ‡¶≤‡ßÅ‡¶≤‡ßç‡¶≤‡¶æ‡¶π Ô∑∫ ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßÄ ‡¶ï‡ßá ‡¶õ‡¶ø‡¶≤‡ßá‡¶®?',
                options: ['‡¶â‡¶Æ‡¶∞ ‡¶∞‡¶æ.', '‡¶Ü‡¶¨‡ßÅ ‡¶¨‡¶ï‡¶∞ ‡¶∞‡¶æ.', '‡¶â‡¶∏‡¶Æ‡¶æ‡¶® ‡¶∞‡¶æ.', '‡¶Ü‡¶≤‡ßÄ ‡¶∞‡¶æ.'],
                correctAnswer: 1
            },
            {
                id: 6,
                type: 'mcq',
                question: '‡¶¨‡¶¶‡¶∞ ‡¶Ø‡ßÅ‡¶¶‡ßç‡¶ß ‡¶ï‡ßã‡¶® ‡¶∏‡¶æ‡¶≤‡ßá ‡¶∏‡¶Ç‡¶ò‡¶ü‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º?',
                options: ['‡ß® ‡¶π‡¶ø‡¶ú‡¶∞‡ßÄ', '‡ß© ‡¶π‡¶ø‡¶ú‡¶∞‡ßÄ', '‡ß™ ‡¶π‡¶ø‡¶ú‡¶∞‡ßÄ', '‡ß´ ‡¶π‡¶ø‡¶ú‡¶∞‡ßÄ'],
                correctAnswer: 0
            },
            {
                id: 7,
                type: 'mcq',
                question: '‡¶â‡¶π‡ßÅ‡¶¶ ‡¶Ø‡ßÅ‡¶¶‡ßç‡¶ß‡ßá ‡¶∞‡¶æ‡¶∏‡ßÇ‡¶≤‡ßÅ‡¶≤‡ßç‡¶≤‡¶æ‡¶π Ô∑∫ ‡¶è‡¶∞ ‡¶ï‡¶Ø‡¶º‡¶ü‡¶ø ‡¶¶‡¶æ‡¶Å‡¶§ ‡¶∂‡¶π‡ßÄ‡¶¶ ‡¶π‡¶Ø‡¶º?',
                options: ['‡ßß‡¶ü‡¶ø', '‡ß®‡¶ü‡¶ø', '‡ß©‡¶ü‡¶ø', '‡ß™‡¶ü‡¶ø'],
                correctAnswer: 1
            },
            {
                id: 8,
                type: 'mcq',
                question: '‡¶Æ‡¶ï‡ßç‡¶ï‡¶æ ‡¶¨‡¶ø‡¶ú‡¶Ø‡¶º ‡¶ï‡ßã‡¶® ‡¶∏‡¶æ‡¶≤‡ßá ‡¶π‡¶Ø‡¶º?',
                options: ['‡ß¨ ‡¶π‡¶ø‡¶ú‡¶∞‡ßÄ', '‡ß≠ ‡¶π‡¶ø‡¶ú‡¶∞‡ßÄ', '‡ßÆ ‡¶π‡¶ø‡¶ú‡¶∞‡ßÄ', '‡ßØ ‡¶π‡¶ø‡¶ú‡¶∞‡ßÄ'],
                correctAnswer: 2
            }
        ];

        // State - ‡¶∏‡¶Æ‡¶Ø‡¶º ‡ß© ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü (‡ßß‡ßÆ‡ß¶ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°)
        let state = {
            view: 'start',
            participant: { name: '', phone: '' },
            answers: {},
            currentQuestion: 0,
            timeLeft: 3 * 60,
            startTime: null,
            timerInterval: null,
            loading: false,
            autoSaveTimeout: null,
            lastSubmission: null
        };

        // WhatsApp function
        function sendToWhatsApp(submission) {
            const message = submission.verificationCode;
            const encodedMessage = encodeURIComponent(message);
            return `https://wa.me/${WHATSAPP_NUMBER}?text=${encodedMessage}`;
        }

        // Storage functions
        async function saveSubmission(submission) {
            try {
                const allSubs = JSON.parse(localStorage.getItem('sirat_subs') || '[]');
                allSubs.push(submission);
                localStorage.setItem('sirat_subs', JSON.stringify(allSubs));
                state.lastSubmission = submission;
                return true;
            } catch (error) {
                console.error('Save error:', error);
                return false;
            }
        }

        // Auto-save
        function autoSave() {
            if (state.view === 'quiz') {
                const progressData = {
                    participant: state.participant,
                    answers: state.answers,
                    currentQuestion: state.currentQuestion,
                    timeLeft: state.timeLeft,
                    startTime: state.startTime
                };
                
                try {
                    localStorage.setItem('quiz_progress', JSON.stringify(progressData));
                    showAutoSaveIndicator('‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§');
                } catch (e) {
                    console.log('Auto-save failed');
                }
            }
        }

        function showAutoSaveIndicator(message) {
            const indicator = document.getElementById('autoSaveIndicator');
            if (indicator) {
                indicator.textContent = '‚úì ' + message;
                indicator.classList.add('show');
                setTimeout(() => {
                    indicator.classList.remove('show');
                }, 2000);
            }
        }

        function loadProgress() {
            try {
                const saved = localStorage.getItem('quiz_progress');
                if (saved) {
                    const data = JSON.parse(saved);
                    if (confirm('‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶ó‡ßç‡¶∞‡ßá‡¶∏ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶ó‡ßá‡¶õ‡ßá‡•§ ‡¶è‡¶ü‡¶ø ‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡ßá‡¶§‡ßá ‡¶ö‡¶æ‡¶®?')) {
                        state.participant = data.participant;
                        state.answers = data.answers;
                        state.currentQuestion = data.currentQuestion;
                        state.timeLeft = data.timeLeft;
                        state.startTime = new Date(data.startTime);
                        state.view = 'quiz';
                        startTimer();
                        render();
                        return true;
                    } else {
                        localStorage.removeItem('quiz_progress');
                    }
                }
            } catch (e) {
                console.log('Could not load progress');
            }
            return false;
        }

        function clearProgress() {
            try {
                localStorage.removeItem('quiz_progress');
            } catch (e) {
                console.log('Could not clear progress');
            }
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return mins.toString().padStart(2, '0') + ':' + secs.toString().padStart(2, '0');
        }

        function startQuiz() {
            const name = document.getElementById('name').value.trim();
            const phone = document.getElementById('phone').value.trim();
            
            if (!name || !phone) {
                alert('‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ‡¶Æ ‡¶ì ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¶‡¶ø‡¶®');
                return;
            }
            
            state.participant = { name, phone };
            state.startTime = new Date();
            state.view = 'quiz';
            startTimer();
            autoSave();
            render();
        }

        function startTimer() {
            state.timerInterval = setInterval(() => {
                state.timeLeft--;
                if (state.timeLeft <= 0) {
                    submitQuiz();
                }
                updateTimer();
                
                if (state.timeLeft % 30 === 0) {
                    autoSave();
                }
            }, 1000);
        }

        function updateTimer() {
            const el = document.getElementById('timer');
            if (el) {
                el.textContent = formatTime(state.timeLeft);
                if (state.timeLeft <= 30) {
                    el.classList.add('warning');
                }
            }
        }

        async function submitQuiz() {
            if (state.timerInterval) {
                clearInterval(state.timerInterval);
            }
            
            state.loading = true;
            render();
            
            const endTime = new Date();
            const timeTaken = Math.floor((endTime - state.startTime) / 1000);
            
            let correct = 0, wrong = 0;
            
            QUESTIONS.forEach(q => {
                if (state.answers[q.id] !== undefined) {
                    if (state.answers[q.id] === q.correctAnswer) {
                        correct++;
                    } else {
                        wrong++;
                    }
                }
            });

            const unanswered = QUESTIONS.length - correct - wrong;
            
            const verificationCode = generateVerificationCode(
                correct, 
                wrong, 
                unanswered, 
                state.participant.phone,
                state.participant.name,
                formatTime(timeTaken)
            );

            const submission = {
                name: state.participant.name,
                phone: state.participant.phone,
                verificationCode: verificationCode,
                mcqCorrect: correct,
                mcqWrong: wrong,
                mcqUnanswered: unanswered,
                timeTaken: formatTime(timeTaken),
                submittedAt: new Date().toLocaleString('bn-BD'),
                timestamp: Date.now()
            };

            const saved = await saveSubmission(submission);
            
            if (saved) {
                clearProgress();
                state.loading = false;
                state.view = 'submitted';
            } else {
                state.loading = false;
                alert('‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
            }
            
            render();
        }

        function selectAnswer(questionId, answerIndex) {
            state.answers[questionId] = answerIndex;
            autoSave();
            render();
        }

        function nextQuestion() {
            if (state.currentQuestion < QUESTIONS.length - 1) {
                state.currentQuestion++;
                autoSave();
                render();
            }
        }

        function prevQuestion() {
            if (state.currentQuestion > 0) {
                state.currentQuestion--;
                render();
            }
        }

        // Render functions
        function renderStart() {
            return `
                <div class="container">
                    <div class="card">
                        <h1>‡¶∏‡ßÄ‡¶∞‡¶æ‡¶§‡ßÅ‡¶® ‡¶®‡¶¨‡ßÄ Ô∑∫ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ</h1>
                        <p class="subtitle">‡¶∞‡¶æ‡¶∏‡ßÇ‡¶≤‡ßÅ‡¶≤‡ßç‡¶≤‡¶æ‡¶π Ô∑∫ ‡¶è‡¶∞ ‡¶ú‡ßÄ‡¶¨‡¶®‡ßÄ ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶ú‡ßç‡¶û‡¶æ‡¶® ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ</p>
                        
                        <div class="info-box">
                            <h3>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£:</h3>
                            <ul>
                                <li>üìù ‡¶Æ‡ßã‡¶ü ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®: ‡ßÆ‡¶ü‡¶ø MCQ</li>
                                <li>‚è∞ ‡¶∏‡¶Æ‡¶Ø‡¶º: ‡ß© ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü</li>
                                <li>‚úÖ ‡¶è‡¶ï‡¶¨‡¶æ‡¶∞ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶∂‡ßá‡¶∑ ‡¶®‡¶æ ‡¶ï‡¶∞‡ßá ‡¶¨‡ßá‡¶∞ ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ</li>
                                <li>üîê ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶∂‡ßá‡¶∑‡ßá ‡¶è‡¶ï‡¶ü‡¶ø Verification Code ‡¶™‡¶æ‡¶¨‡ßá‡¶®</li>
                                <li>üì± Verification Code ‡¶ü‡¶ø ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á WhatsApp ‡¶è ‡¶™‡¶æ‡¶†‡¶æ‡¶§‡ßá ‡¶π‡¶¨‡ßá</li>
                                <li>"Verification Code ‡¶è ‡¶ï‡ßã‡¶® ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶≤‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá"</li>
                                <li>üéØ ‡¶∏‡¶¨ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßá‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®</li>
                            </ul>
                        </div>

                        <div class="form-group">
                            <label>üë§ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ *</label>
                            <input type="text" id="name" placeholder="‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®">
                        </div>

                        <div class="form-group">
                            <label>üì± ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ *</label>
                            <input type="tel" id="phone" placeholder="01XXXXXXXXX">
                        </div>

                        <button class="btn btn-primary" onclick="startQuiz()">
                            ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®
                        </button>
                    </div>
                </div>
            `;
        }

        function renderQuiz() {
            if (state.loading) {
                return '<div class="loading">‡¶ú‡¶Æ‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>';
            }

            const q = QUESTIONS[state.currentQuestion];
            const progress = ((state.currentQuestion + 1) / QUESTIONS.length) * 100;

            const optionsHTML = q.options.map((opt, idx) => {
                const selected = state.answers[q.id] === idx ? 'selected' : '';
                return `
                    <button class="option ${selected}" onclick="selectAnswer(${q.id}, ${idx})">
                        <strong>${String.fromCharCode(65 + idx)}.</strong> ${opt}
                    </button>
                `;
            }).join('');

            return `
                <div class="container">
                    <div class="timer-box">
                        <div class="timer-header">
                            <div style="color:#065f46; font-weight:bold;">
                                ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ${state.currentQuestion + 1} / ${QUESTIONS.length}
                            </div>
                            <div class="timer" id="timerElement">
                                ‚è∞ <span id="timer">${formatTime(state.timeLeft)}</span>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width:${progress}%"></div>
                        </div>
                    </div>

                    <div class="question-card">
                        <span class="question-badge">‡¶¨‡¶π‡ßÅ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®‡ßÄ</span>
                        <div class="question-text">${q.question}</div>
                        ${optionsHTML}
                    </div>

                    <div class="nav-buttons">
                        <button class="btn btn-secondary" onclick="prevQuestion()" 
                                ${state.currentQuestion === 0 ? 'disabled' : ''}>
                            ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ
                        </button>
                        ${state.currentQuestion < QUESTIONS.length - 1 ? `
                            <button class="btn btn-primary" onclick="nextQuestion()">
                                ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®
                            </button>
                        ` : `
                            <button class="btn btn-danger" onclick="submitQuiz()">
                                ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®
                            </button>
                        `}
                    </div>
                </div>
            `;
        }

        function renderSubmitted() {
            const whatsappUrl = sendToWhatsApp(state.lastSubmission);
            const displayNumber = WHATSAPP_NUMBER.replace('88', '').replace(/(\d{4})(\d{3})(\d{4})/, '$1-$2-$3');
            
            return `
                <div class="container" style="margin-top:50px;">
                    <div class="card">
                        <div class="success-icon">‚úÖ</div>
                        <div class="success-message">
                            <h2>‡¶ú‡¶Æ‡¶æ ‡¶∏‡¶´‡¶≤ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!</h2>
                            <p>${state.participant.name}, ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶â‡¶§‡ßç‡¶§‡¶∞‡¶™‡¶§‡ßç‡¶∞ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§</p>
                            
                            <div class="code-box">
                                <div class="code-label">üîê ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ Verification Code</div>
                                <div class="verification-code">${state.lastSubmission.verificationCode}</div>
                                <div class="code-instruction">‡¶è‡¶á Code ‡¶ü‡¶ø ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç WhatsApp ‡¶è ‡¶™‡¶æ‡¶†‡¶æ‡¶®</div>
                            </div>

                            <div class="whatsapp-box">
                                <h3>üì± WhatsApp ‡¶è Code ‡¶™‡¶æ‡¶†‡¶æ‡¶®</h3>
                                <p style="color: #6b7280; margin: 10px 0;">
                                    ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ Code ‡¶™‡¶æ‡¶†‡¶æ‡¶®
                                </p>
                                <div class="whatsapp-number" style="font-weight: bold; color: #25D366; font-size: 18px; margin: 10px 0;">${displayNumber}</div>
                                <button class="btn btn-whatsapp" onclick="window.open('${whatsappUrl}', '_blank')" style="margin-top: 15px;">
                                    <span style="font-size: 24px;">üì±</span>
                                    WhatsApp ‡¶è ‡¶™‡¶æ‡¶†‡¶æ‡¶®
                                </button>
                            </div>

                            <p style="color:#6b7280; margin-top:30px; font-size: 14px;">
                                ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶â‡¶§‡ßç‡¶§‡¶Æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶æ‡¶® ‡¶¶‡¶ø‡¶®‡•§ ü§≤
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }

        function render() {
            const app = document.getElementById('app');
            
            if (state.view === 'start') {
                app.innerHTML = renderStart();
            } else if (state.view === 'quiz') {
                app.innerHTML = renderQuiz();
            } else if (state.view === 'submitted') {
                app.innerHTML = renderSubmitted();
            }
        }

        // Initialize
        window.onload = function() {
            if (!loadProgress()) {
                render();
            }
        };
    </script>
</body>
</html>
